{
  "info": {
    "name": "Migunani Backend API",
    "_postman_id": "8d4a1d57-5f4c-4e42-b89f-ef5c8f4ef9f1",
    "description": "Postman collection untuk testing endpoint backend Migunani Motor berdasarkan route aktual di back_end/src/routes.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    { "key": "baseUrl", "value": "http://localhost:5000/api/v1" },
    { "key": "token", "value": "" },
    { "key": "productId", "value": "" },
    { "key": "productSku", "value": "" },
    { "key": "cartItemId", "value": "" },
    { "key": "orderId", "value": "" },
    { "key": "sessionId", "value": "" },
    { "key": "supplierId", "value": "" }
  ],
  "item": [
    {
      "name": "Auth",
      "item": [
        {
          "name": "Register Customer",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "let data = {};",
                  "try { data = pm.response.json(); } catch (e) {}",
                  "if (data.token) pm.collectionVariables.set('token', data.token);"
                ]
              }
            }
          ],
          "request": {
            "auth": { "type": "noauth" },
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Customer Test\",\n  \"email\": \"customer.test@example.com\",\n  \"password\": \"customer123\",\n  \"whatsapp_number\": \"6281234567890\"\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": "{{baseUrl}}/auth/register",
            "description": "Register user role customer."
          }
        },
        {
          "name": "Login (Email)",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "let data = {};",
                  "try { data = pm.response.json(); } catch (e) {}",
                  "if (data.token) pm.collectionVariables.set('token', data.token);",
                  "if (data.user && data.user.id) pm.collectionVariables.set('userId', data.user.id);"
                ]
              }
            }
          ],
          "request": {
            "auth": { "type": "noauth" },
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"admin@migunani.com\",\n  \"password\": \"admin123\"\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": "{{baseUrl}}/auth/login",
            "description": "Login dengan email. Token otomatis disimpan ke collection variable {{token}}."
          }
        },
        {
          "name": "Login (WhatsApp)",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "let data = {};",
                  "try { data = pm.response.json(); } catch (e) {}",
                  "if (data.token) pm.collectionVariables.set('token', data.token);"
                ]
              }
            }
          ],
          "request": {
            "auth": { "type": "noauth" },
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"whatsapp_number\": \"6281234567890\",\n  \"password\": \"customer123\"\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": "{{baseUrl}}/auth/login"
          }
        }
      ]
    },
    {
      "name": "Catalog (Public)",
      "item": [
        {
          "name": "Get Catalog",
          "request": {
            "auth": { "type": "noauth" },
            "method": "GET",
            "url": "{{baseUrl}}/catalog?page=1&limit=12&search=&category_id=&min_price=&max_price=&sort=price_asc"
          }
        },
        {
          "name": "Get Product Detail",
          "request": {
            "auth": { "type": "noauth" },
            "method": "GET",
            "url": "{{baseUrl}}/catalog/{{productId}}",
            "description": "Bisa pakai UUID product atau SKU."
          }
        }
      ]
    },
    {
      "name": "Cart (Auth)",
      "item": [
        {
          "name": "Get Cart",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "GET",
            "url": "{{baseUrl}}/cart"
          }
        },
        {
          "name": "Add To Cart",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"product_id\": \"{{productId}}\",\n  \"qty\": 1\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": "{{baseUrl}}/cart"
          }
        },
        {
          "name": "Update Cart Item Qty",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "PATCH",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"qty\": 2\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": "{{baseUrl}}/cart/item/{{cartItemId}}"
          }
        },
        {
          "name": "Remove Cart Item",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "DELETE",
            "url": "{{baseUrl}}/cart/item/{{cartItemId}}"
          }
        },
        {
          "name": "Clear Cart",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "DELETE",
            "url": "{{baseUrl}}/cart"
          }
        }
      ]
    },
    {
      "name": "Orders (Customer + Admin)",
      "item": [
        {
          "name": "Checkout",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "let data = {};",
                  "try { data = pm.response.json(); } catch (e) {}",
                  "if (data.order_id) pm.collectionVariables.set('orderId', data.order_id);"
                ]
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"from_cart\": false,\n  \"payment_method\": \"transfer_manual\",\n  \"items\": [\n    {\n      \"product_id\": \"{{productId}}\",\n      \"qty\": 1\n    }\n  ]\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": "{{baseUrl}}/orders/checkout"
          }
        },
        {
          "name": "Get My Orders",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "GET",
            "url": "{{baseUrl}}/orders/my-orders?page=1&limit=10&status="
          }
        },
        {
          "name": "Get Order Detail",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "GET",
            "url": "{{baseUrl}}/orders/{{orderId}}"
          }
        },
        {
          "name": "Upload Payment Proof",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "POST",
            "body": {
              "mode": "formdata",
              "formdata": [
                { "key": "proof", "type": "file", "src": "" }
              ]
            },
            "url": "{{baseUrl}}/orders/{{orderId}}/proof"
          }
        },
        {
          "name": "Admin - List Orders",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "GET",
            "url": "{{baseUrl}}/orders/admin/list?page=1&limit=10&status="
          }
        },
        {
          "name": "Admin - Update Order Status",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "PATCH",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"processing\"\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": "{{baseUrl}}/orders/admin/{{orderId}}/status"
          }
        }
      ]
    },
    {
      "name": "Finance (Admin)",
      "item": [
        {
          "name": "Get Expenses",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "GET",
            "url": "{{baseUrl}}/admin/finance/expenses?page=1&limit=10&startDate=2026-01-01&endDate=2026-12-31"
          }
        },
        {
          "name": "Create Expense",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"category\": \"Operasional\",\n  \"amount\": 150000,\n  \"date\": \"2026-02-01\",\n  \"note\": \"Beli ATK\"\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": "{{baseUrl}}/admin/finance/expenses"
          }
        },
        {
          "name": "Verify Payment (Approve/Reject)",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "PATCH",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"action\": \"approve\"\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": "{{baseUrl}}/admin/finance/orders/{{orderId}}/verify"
          }
        },
        {
          "name": "Get Accounts Receivable",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "GET",
            "url": "{{baseUrl}}/admin/finance/ar"
          }
        },
        {
          "name": "Get Profit & Loss",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "GET",
            "url": "{{baseUrl}}/admin/finance/pnl?startDate=2026-01-01&endDate=2026-12-31"
          }
        }
      ]
    },
    {
      "name": "Inventory (Admin/Gudang)",
      "item": [
        {
          "name": "Create Product",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "let data = {};",
                  "try { data = pm.response.json(); } catch (e) {}",
                  "if (data.id) pm.collectionVariables.set('productId', data.id);",
                  "if (data.sku) pm.collectionVariables.set('productSku', data.sku);"
                ]
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"sku\": \"SKU-TEST-001\",\n  \"barcode\": \"8991234567890\",\n  \"name\": \"Produk Test\",\n  \"base_price\": 10000,\n  \"price\": 15000,\n  \"unit\": \"pcs\",\n  \"min_stock\": 5,\n  \"category_id\": null,\n  \"stock_quantity\": 10\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": "{{baseUrl}}/admin/products"
          }
        },
        {
          "name": "Update Product",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "PUT",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Produk Test Update\",\n  \"price\": 17000\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": "{{baseUrl}}/admin/products/{{productId}}"
          }
        },
        {
          "name": "Create Stock Mutation",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"product_id\": \"{{productId}}\",\n  \"type\": \"in\",\n  \"qty\": 5,\n  \"note\": \"Restock\",\n  \"reference_id\": \"PO-TEST-001\"\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": "{{baseUrl}}/admin/inventory/mutation"
          }
        },
        {
          "name": "Create Purchase Order",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"supplier_id\": \"{{supplierId}}\",\n  \"total_cost\": 1000000\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": "{{baseUrl}}/admin/inventory/po"
          }
        },
        {
          "name": "Scan Product by SKU",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "GET",
            "url": "{{baseUrl}}/admin/inventory/scan/{{productSku}}"
          }
        }
      ]
    },
    {
      "name": "POS (Kasir/Admin)",
      "item": [
        {
          "name": "Start Shift",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"start_cash\": 500000\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": "{{baseUrl}}/pos/shift/start"
          }
        },
        {
          "name": "End Shift",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"end_cash\": 650000\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": "{{baseUrl}}/pos/shift/end"
          }
        },
        {
          "name": "Hold Order",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"customer_name\": \"Walk-in Guest\",\n  \"items\": [\n    {\n      \"product_id\": \"{{productId}}\",\n      \"qty\": 1\n    }\n  ]\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": "{{baseUrl}}/pos/hold"
          }
        },
        {
          "name": "Get Hold Orders",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "GET",
            "url": "{{baseUrl}}/pos/hold"
          }
        },
        {
          "name": "Resume Hold Order",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "GET",
            "url": "{{baseUrl}}/pos/resume/{{orderId}}"
          }
        },
        {
          "name": "Void Transaction",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "DELETE",
            "url": "{{baseUrl}}/pos/void/{{orderId}}"
          }
        }
      ]
    },
    {
      "name": "Driver",
      "item": [
        {
          "name": "Get Assigned Orders",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "GET",
            "url": "{{baseUrl}}/driver/orders?status="
          }
        },
        {
          "name": "Complete Delivery",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "POST",
            "body": {
              "mode": "formdata",
              "formdata": [
                { "key": "proof", "type": "file", "src": "" }
              ]
            },
            "url": "{{baseUrl}}/driver/orders/{{orderId}}/complete"
          }
        },
        {
          "name": "Get Driver Wallet",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "GET",
            "url": "{{baseUrl}}/driver/wallet"
          }
        }
      ]
    },
    {
      "name": "Chat (Admin)",
      "item": [
        {
          "name": "Get Sessions",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "let data = {};",
                  "try { data = pm.response.json(); } catch (e) {}",
                  "if (data.sessions && data.sessions.length > 0) {",
                  "  pm.collectionVariables.set('sessionId', data.sessions[0].id);",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "GET",
            "url": "{{baseUrl}}/chat/sessions?page=1&limit=20&status=all"
          }
        },
        {
          "name": "Get Session Messages",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "GET",
            "url": "{{baseUrl}}/chat/sessions/{{sessionId}}/messages?page=1&limit=50"
          }
        },
        {
          "name": "Reply To Chat",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"message\": \"Halo, ada yang bisa kami bantu?\"\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": "{{baseUrl}}/chat/sessions/{{sessionId}}/reply"
          }
        }
      ]
    },
    {
      "name": "WhatsApp (Admin)",
      "item": [
        {
          "name": "Get QR",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "GET",
            "url": "{{baseUrl}}/whatsapp/qr"
          }
        },
        {
          "name": "Get WhatsApp Status",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "GET",
            "url": "{{baseUrl}}/whatsapp/status"
          }
        },
        {
          "name": "Logout WhatsApp",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [{ "key": "token", "value": "{{token}}", "type": "string" }]
            },
            "method": "POST",
            "url": "{{baseUrl}}/whatsapp/logout"
          }
        }
      ]
    }
  ]
}
